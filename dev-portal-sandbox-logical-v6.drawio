<mxfile host="app.diagrams.net" modified="2025-09-08T07:48:24Z" agent="python" version="20.8.16" editor="diagramly" type="device" compressed="false">
  <diagram id="logical-arch-v6" name="Developer Portal + Sandbox (Logical, V6)">
    <mxGraphModel dx="1920" dy="1080" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1920" pageHeight="1080" background="#FFFFFF" math="0" shadow="0">
      <root>
        <mxCell id="0"/><mxCell id="1" parent="0"/><mxCell id="title" value="Developer Portal with Isolated Sandbox - Logical Architecture (V6)" style="text;html=1;align=center;verticalAlign=middle;fontStyle=1;fontSize=18" vertex="1" parent="1"><mxGeometry x="380" y="10" width="1160" height="40" as="geometry"/></mxCell><mxCell id="laneClients" value="Clients" style="swimlane;horizontal=0;rounded=1;html=1;startSize=28;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1" vertex="1" parent="1"><mxGeometry x="20" y="70" width="360" height="220" as="geometry"/></mxCell><mxCell id="laneEdge" value="Edge" style="swimlane;horizontal=0;rounded=1;html=1;startSize=28;fillColor=#fff2cc;strokeColor=#d6b656;fontStyle=1" vertex="1" parent="1"><mxGeometry x="400" y="70" width="360" height="220" as="geometry"/></mxCell><mxCell id="lanePortal" value="Developer Portal" style="swimlane;horizontal=0;rounded=1;html=1;startSize=28;fillColor=#e1d5e7;strokeColor=#9673a6;fontStyle=1" vertex="1" parent="1"><mxGeometry x="780" y="70" width="440" height="220" as="geometry"/></mxCell><mxCell id="laneCtrl" value="Control Plane" style="swimlane;horizontal=0;rounded=1;html=1;startSize=28;fillColor=#ffe6cc;strokeColor=#d79b00;fontStyle=1" vertex="1" parent="1"><mxGeometry x="1240" y="70" width="360" height="220" as="geometry"/></mxCell><mxCell id="laneAI" value="LLM Runtime" style="swimlane;horizontal=0;rounded=1;html=1;startSize=28;fillColor=#f5f5f5;strokeColor=#999999;fontStyle=1" vertex="1" parent="1"><mxGeometry x="20" y="300" width="360" height="180" as="geometry"/></mxCell><mxCell id="laneSandbox" value="Sandbox Account (Isolated)" style="swimlane;horizontal=0;rounded=1;html=1;startSize=28;fillColor=#f5f5f5;strokeColor=#6c8ebf;fontStyle=1" vertex="1" parent="1"><mxGeometry x="400" y="300" width="1200" height="480" as="geometry"/></mxCell><mxCell id="laneProd" value="Production (separate account/VPC) - NO ROUTE" style="swimlane;horizontal=0;rounded=1;html=1;startSize=28;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1;dashed=1" vertex="1" parent="1"><mxGeometry x="1610" y="300" width="260" height="480" as="geometry"/></mxCell><mxCell id="dev" value="External Developer&#10;Apps/SDKs/Postman&#10;Webhook endpoint" style="rounded=1;whiteSpace=wrap;html=1;spacing=8;strokeColor=#6c8ebf;fillColor=#ffffff" vertex="1" parent="1"><mxGeometry x="40" y="120" width="300" height="120" as="geometry"/></mxCell><mxCell id="waf" value="WAF/CDN" style="rounded=1;whiteSpace=wrap;html=1;spacing=8;strokeColor=#d6b656;fillColor=#ffffff" vertex="1" parent="1"><mxGeometry x="420" y="110" width="140" height="60" as="geometry"/></mxCell><mxCell id="apigw" value="API Gateway&#10;Routing/Auth/Rate limits/Idempotency" style="rounded=1;whiteSpace=wrap;html=1;spacing=8;strokeColor=#d6b656;fillColor=#ffffff" vertex="1" parent="1"><mxGeometry x="580" y="110" width="180" height="100" as="geometry"/></mxCell><mxCell id="egressgw" value="(Optional) Egress Gateway" style="rounded=1;whiteSpace=wrap;html=1;spacing=8;strokeColor=#d6b656;fillColor=#ffffff" vertex="1" parent="1"><mxGeometry x="420" y="190" width="340" height="50" as="geometry"/></mxCell><mxCell id="portalCore" value="Portal Core&#10;Docs/Explorer/Apps/Keys/Logs/Replay/Webhook Tester" style="rounded=1;whiteSpace=wrap;html=1;spacing=8;strokeColor=#9673a6;fillColor=#ffffff" vertex="1" parent="1"><mxGeometry x="800" y="110" width="240" height="130" as="geometry"/></mxCell><mxCell id="assistantUI" value="LLM Assistant UI&#10;Chat / Apply / Export" style="rounded=1;whiteSpace=wrap;html=1;spacing=8;strokeColor=#9673a6;fillColor=#ffffff" vertex="1" parent="1"><mxGeometry x="1060" y="110" width="160" height="80" as="geometry"/></mxCell><mxCell id="mcp" value="MCP Server&#10;Session memory&#10;Tool routing&#10;Allowlist + Redaction&#10;Prepare vs Execute" style="rounded=1;whiteSpace=wrap;html=1;spacing=8;strokeColor=#9673a6;fillColor=#ffffff" vertex="1" parent="1"><mxGeometry x="800" y="230" width="420" height="60" as="geometry"/></mxCell><mxCell id="ctrlMgr" value="Sandbox Manager&#10;Create/Update/Delete sandboxes&#10;Namespace/Policy/Quota/Secrets&#10;Ingress &amp; DNS&#10;TTL &amp; cleanup" style="rounded=1;whiteSpace=wrap;html=1;spacing=8;strokeColor=#d79b00;fillColor=#ffffff" vertex="1" parent="1"><mxGeometry x="1260" y="120" width="320" height="140" as="geometry"/></mxCell><mxCell id="llm" value="LLM Runtime&#10;RAG (spec/docs)&#10;Redacted prompts" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#999999;fillColor=#ffffff" vertex="1" parent="1"><mxGeometry x="40" y="350" width="300" height="100" as="geometry"/></mxCell><mxCell id="ingress" value="Ingress + DNS&#10;*.sbx.api.example.com" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#6c8ebf;fillColor=#d5e8d4" vertex="1" parent="1"><mxGeometry x="420" y="350" width="220" height="70" as="geometry"/></mxCell><mxCell id="obs" value="Observability Collector&#10;OTel logs/traces/metrics" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#6c8ebf;fillColor=#d5e8d4" vertex="1" parent="1"><mxGeometry x="660" y="350" width="240" height="70" as="geometry"/></mxCell><mxCell id="secrets" value="Secrets Manager (Sandbox)" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#6c8ebf;fillColor=#d5e8d4" vertex="1" parent="1"><mxGeometry x="920" y="350" width="220" height="70" as="geometry"/></mxCell><mxCell id="rbac" value="RBAC least-privilege&#10;Image signing policy" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#6c8ebf;fillColor=#ffffff;fontSize=10" vertex="1" parent="1"><mxGeometry x="1160" y="350" width="240" height="60" as="geometry"/></mxCell><mxCell id="backup" value="Backups &amp; DR&#10;(per-schema restore)" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#6c8ebf;fillColor=#ffffff;fontSize=10" vertex="1" parent="1"><mxGeometry x="1420" y="350" width="160" height="60" as="geometry"/></mxCell><mxCell id="cluster" value="Kubernetes Cluster - Namespace per sandbox" style="swimlane;rounded=1;html=1;startSize=20;strokeColor=#82b366;fillColor=#ffffff;fontStyle=1" vertex="1" parent="1"><mxGeometry x="420" y="430" width="1120" height="270" as="geometry"/></mxCell><mxCell id="namespace" value="Namespace (sbx-123)&#10;API Pods | Scenario Engine | Time Travel/Record-Replay/Chaos toggles | Webhook Emitter (HMAC+DLQ) | Data slice (schema) | NetworkPolicy/Quota/PSA" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#dae8fc" vertex="1" parent="1"><mxGeometry x="440" y="470" width="1080" height="180" as="geometry"/></mxCell><mxCell id="advanced" value="Advanced features:&#10;- Time travel &amp; schedulers&#10;- Recordâ€“replay (anonymised)&#10;- Chaos toggles (latency, 5xx)&#10;- Domain-specific simulators" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#82b366;fillColor=#ffffff;fontSize=10" vertex="1" parent="1"><mxGeometry x="1460" y="430" width="260" height="100" as="geometry"/></mxCell><mxCell id="metrics" value="Metrics &amp; Pitfalls:&#10;TTFSC, Webhook success, Scenario coverage, Drift&#10;Watch for cost explosions, drift, unrealistic data" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#b85450;fillColor=#ffffff;fontSize=9" vertex="1" parent="1"><mxGeometry x="1460" y="540" width="260" height="120" as="geometry"/></mxCell><mxCell id="prodWarn" value="NO CONNECTIVITY (network, IAM, secrets)" style="text;html=1;fontStyle=1;fontColor=#b85450" vertex="1" parent="1"><mxGeometry x="1520" y="310" width="300" height="20" as="geometry"/></mxCell><mxCell id="flow1" edge="1" parent="1" source="dev" target="waf" style="edgeStyle=orthogonalEdgeStyle;rounded=1;endArrow=block;endFill=1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="flow1_lbl" value="(1) HTTPS request" style="text;html=1;fontSize=10" vertex="1" parent="1"><mxGeometry x="380" y="150" width="120" height="20" as="geometry"/></mxCell><mxCell id="flow2" edge="1" parent="1" source="waf" target="apigw" style="edgeStyle=orthogonalEdgeStyle;rounded=1;endArrow=block;endFill=1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="flow2_lbl" value="(2) WAF -&gt; Gateway" style="text;html=1;fontSize=10" vertex="1" parent="1"><mxGeometry x="560" y="145" width="150" height="20" as="geometry"/></mxCell><mxCell id="flow3" edge="1" parent="1" source="apigw" target="ingress" style="edgeStyle=orthogonalEdgeStyle;rounded=1;endArrow=block;endFill=1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="flow3_lbl" value="(3) Route sandbox subdomain" style="text;html=1;fontSize=10" vertex="1" parent="1"><mxGeometry x="640" y="270" width="200" height="20" as="geometry"/></mxCell><mxCell id="flow4" edge="1" parent="1" source="portalCore" target="ctrlMgr" style="edgeStyle=orthogonalEdgeStyle;rounded=1;endArrow=block;endFill=1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="flow4_lbl" value="(4) Create/Manage Sandbox" style="text;html=1;fontSize=10" vertex="1" parent="1"><mxGeometry x="1190" y="160" width="200" height="20" as="geometry"/></mxCell><mxCell id="flow5" edge="1" parent="1" source="ctrlMgr" target="cluster" style="edgeStyle=orthogonalEdgeStyle;rounded=1;endArrow=block;endFill=1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="flow5_lbl" value="(5) Provision namespace/policies/secrets" style="text;html=1;fontSize=10" vertex="1" parent="1"><mxGeometry x="1220" y="430" width="260" height="20" as="geometry"/></mxCell><mxCell id="flow6" edge="1" parent="1" source="assistantUI" target="mcp" style="edgeStyle=orthogonalEdgeStyle;rounded=1;endArrow=block;endFill=1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="flow6_lbl" value="(6) Plan &amp; tool calls via MCP" style="text;html=1;fontSize=10" vertex="1" parent="1"><mxGeometry x="980" y="210" width="240" height="20" as="geometry"/></mxCell><mxCell id="flow7" edge="1" parent="1" source="mcp" target="llm" style="edgeStyle=orthogonalEdgeStyle;rounded=1;endArrow=block;endFill=1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="flow7_lbl" value="(7) Minimal redacted prompt" style="text;html=1;fontSize=10" vertex="1" parent="1"><mxGeometry x="80" y="390" width="240" height="20" as="geometry"/></mxCell><mxCell id="flow8" edge="1" parent="1" source="namespace" target="dev" style="edgeStyle=orthogonalEdgeStyle;rounded=1;endArrow=block;endFill=1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="flow8_lbl" value="(8) Webhooks (HMAC + retries)" style="text;html=1;fontSize=10" vertex="1" parent="1"><mxGeometry x="220" y="580" width="320" height="20" as="geometry"/></mxCell><mxCell id="legend" value="Legend:&#10;(1)-(3) Baseline request flows&#10;(4)-(5) Control plane provisioning&#10;(6)-(7) Assistant &amp; MCP flows&#10;(8) Webhook delivery&#10;Callouts show RBAC &amp; image policy, backups, advanced features, metrics/pitfalls" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#000000;fillColor=#ffffff;fontSize=10" vertex="1" parent="1"><mxGeometry x="1460" y="660" width="260" height="140" as="geometry"/></mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>